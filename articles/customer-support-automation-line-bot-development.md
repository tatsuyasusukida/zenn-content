---
title: "[WIP]ãŠå•ã„åˆã‚ã›å¯¾å¿œè‡ªå‹•åŒ– LINE ãƒœãƒƒãƒˆé–‹ç™ºã®çµŒé¨“è«‡"
emoji: "ğŸ¤–"
type: "tech"
topics: ["line", "typescript", "gcp", "nestjs"]
published: false
---

## ã¯ã˜ã‚ã«

ä»Šå¹´ã® 2 æœˆé ƒã‹ã‚‰å®šæœŸé…é”ã‚µãƒ¼ãƒ“ã‚¹ã®ãŠå•ã„åˆã‚ã›å¯¾å¿œè‡ªå‹•åŒ– LINE ãƒœãƒƒãƒˆé–‹ç™ºã«é–¢ã‚ã‚‰ã›ã¦ã‚‚ã‚‰ã„ã¾ã—ãŸã€‚ã“ã®è¨˜äº‹ã§ã¯é–‹ç™ºã‚’é€šã˜ã¦å¾—ã‚‰ã‚ŒãŸçŸ¥è¦‹ã‚’ã¾ã¨ã‚ãŸã„ã¨æ€ã„ã¾ã™ã€‚

## ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«ã¤ã„ã¦

ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¯ç”ŸèŠ±ã®å®šæœŸé…é”ã‚’ä¸»ãªäº‹æ¥­å†…å®¹ã¨ã™ã‚‹å°å£²æ¥­ã®ä¼šç¤¾ã§ã™ã€‚å…¨å›½å±•é–‹ã¯ã—ã¦ãŠã‚‰ãšã€è‡ªç¤¾ã®é…é”ã‚¹ã‚¿ãƒƒãƒ•ãŒè¿‘éš£ã‚¨ãƒªã‚¢ã«ç›´æ¥ãŠå±Šã‘ã—ã¦ã„ã¾ã™ã€‚é…é”ã®é »åº¦ã¯ 2 é€±é–“ã« 1 å›ã§ã‚ã‚Šã€ãƒ«ãƒ¼ãƒˆé…é€ã—ã¦ã„ã‚‹éƒ½åˆã§ã‚¨ãƒªã‚¢ã«ã‚ˆã£ã¦é…é”ã™ã‚‹æ›œæ—¥ãŒå›ºå®šã•ã‚Œã¦ã„ã¾ã™ã€‚ãŠå®¢ã•ã¾ã¯é…é”æ—¥ã® 4 æ—¥å‰ã¾ã§ãªã‚‰ç„¡æ–™ã§ã‚­ãƒ£ãƒ³ã‚»ãƒ«å¯èƒ½ã§ã™ã€‚

## èª²é¡Œ

ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¯ãŠå®¢ã•ã¾ã¨ã®ã‚„ã‚Šå–ã‚Šã‚’é›»è©±ã¨ LINE ã§è¡Œã£ã¦ã„ã¾ã™ãŒä¸‹è¨˜ã®ã‚ˆã†ãªèª²é¡ŒãŒã‚ã‚Šã¾ã—ãŸã€‚

- é…é”æ—¥ç¢ºèªã‚„ã‚­ãƒ£ãƒ³ã‚»ãƒ«ãªã©ã®ãŠå•ã„åˆã‚ã›ãŒé »ç¹ã«ã‚ã‚‹ã®ã§æ‰‹é–“ãŒã‹ã‹ã‚‹ã€‚
- é…é”ã‚¹ã‚¿ãƒƒãƒ•ã®éƒ½åˆãªã©ã§é…é”æ—¥ã«å¤‰æ›´ãŒç”Ÿã˜ãŸå ´åˆã«å½±éŸ¿ã®ã‚ã‚‹ãŠå®¢ã•ã‚“å…¨å“¡ã«å€‹åˆ¥é€£çµ¡ã™ã‚‹ã®ãŒå¤§å¤‰ã€‚

### ã‚ˆãã‚ã‚‹ãŠå•ã„åˆã‚ã›

ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‹ã‚‰ãƒ’ã‚¢ãƒªãƒ³ã‚°ã—ãŸçµæœã€ã‚ˆãã‚ã‚‹ãŠå•ã„åˆã‚ã›ã«ã¤ã„ã¦ã¯ä¸‹è¨˜ã®é€šã‚Šã§ã—ãŸã€‚

- é…é”æ—¥ã®ç¢ºèª
- æ¬¡å›é…é”ã®ã‚­ãƒ£ãƒ³ã‚»ãƒ«
- ã‚¯ãƒ¬ãƒ¼ãƒ ï¼ˆä¾‹ï¼šèŠ±ãŒç—›ã‚“ã§ã„ãŸã€å•†å“ãŒå±Šã„ã¦ã„ãªã„ï¼‰
- ãŠé‡‘ã‚„å•†å“ã®ç½®ãå ´æ‰€

## ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã¨ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆ

ä¸Šè¨˜ã®èª²é¡Œã‚’è§£æ±ºã™ã‚‹ãŸã‚ã«ä¸‹è¨˜ 2 ã¤ã®ã—ãã¿ã‚’è¨­ã‘ã‚‹ã“ã¨ãŒã‚¢ãƒ—ãƒ­ãƒ¼ãƒã® 1 ã¤ã¨ã—ã¦è€ƒãˆã‚‰ã‚Œã¾ã—ãŸã€‚

- ãŠå®¢ã•ã¾ã‹ã‚‰ã®ã‚ˆãã‚ã‚‹ãŠå•ã„åˆã‚ã›ã«å¯¾ã—ã¦è‡ªå‹•å¿œç­”ã™ã‚‹ã—ãã¿
- è¤‡æ•°ã®ãŠå®¢ã•ã¾ã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ä¸€æ–‰é€ä¿¡ã™ã‚‹ã—ãã¿

ã“ã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã‚’å®Ÿç¾ã™ã‚‹ãŸã‚ã«ä¸‹è¨˜ã®ã‚ˆã†ãªã‚·ã‚¹ãƒ†ãƒ æ§‹æˆã®ãŠå•ã„åˆã‚ã›å¯¾å¿œè‡ªå‹•åŒ– LINE ãƒœãƒƒãƒˆã‚’ææ¡ˆã—ã¾ã—ãŸã€‚

```mermaid
graph BT
  subgraph Chatwork
    ChatworkAPI[Chatwork API]
  end

  subgraph LINE å…¬å¼ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ
    RichMenu[ãƒªãƒƒãƒãƒ¡ãƒ‹ãƒ¥ãƒ¼] -->|ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ| LINE[LINE Messaging API]
  end

  subgraph GCP
    Admin[ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ] -->|èª­ã¿æ›¸ã| CloudSQL[(Cloud SQL)]
    Bot[LINE ãƒœãƒƒãƒˆ] -->|èª­ã¿æ›¸ã| CloudSQL
  end

  LINE -->|Webhook| Bot
  Bot -->|ãƒªãƒ—ãƒ©ã‚¤| LINE
  Bot -->|é€šçŸ¥| ChatworkAPI
  Admin -->|ä¸€æ–‰é€ä¿¡| LINE
  Client((ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ)) -->|Webã‚¢ã‚¯ã‚»ã‚¹| Admin
  Customer((ãŠå®¢ã•ã¾)) -->|ãƒœã‚¿ãƒ³æŠ¼ä¸‹| RichMenu
```

### ãƒªãƒƒãƒãƒ¡ãƒ‹ãƒ¥ãƒ¼

ãƒªãƒƒãƒãƒ¡ãƒ‹ãƒ¥ãƒ¼ã¯ LINE å…¬å¼ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ãƒˆãƒ¼ã‚¯ç”»é¢ä¸‹éƒ¨ã«è¡¨ç¤ºã•ã‚Œã‚‹ãƒ¡ãƒ‹ãƒ¥ãƒ¼ç”»åƒã§ã™ã€‚ãŠå®¢ã•ã¾ãŒãƒªãƒƒãƒãƒ¡ãƒ‹ãƒ¥ãƒ¼å†…ã®ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã¨ã€Œ> é…é”æ—¥ã®ç¢ºèªã€ãªã©ã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãŒé€ä¿¡ã•ã‚Œã¾ã™ã€‚ãƒªãƒƒãƒãƒ¡ãƒ‹ãƒ¥ãƒ¼ã¯ãŠå®¢ã•ã¾ãŒ LINE ãƒœãƒƒãƒˆã‚’åˆ©ç”¨ã™ã‚‹ãŸã‚ã®ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆã«ãªã‚Šã¾ã™ã€‚ä¾‹ã‚’ä¸‹è¨˜ã«ç¤ºã—ã¾ã™ã€‚

![LINE ãƒˆãƒ¼ã‚¯ç”»é¢ä¸‹éƒ¨ã« 6 ã¤ã®ãƒœã‚¿ãƒ³ã‹ã‚‰æ§‹æˆã•ã‚Œã‚‹ãƒ¡ãƒ‹ãƒ¥ãƒ¼ç”»åƒãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã¾ã™ã€‚](/images/articles/customer-support-automation-line-bot-development/rich-menu.png)
_ãƒªãƒƒãƒãƒ¡ãƒ‹ãƒ¥ãƒ¼ç”»åƒã®ä¾‹ï¼ˆ[LINE å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](customer-support-automation-line-bot-development)ã‚ˆã‚Šå¼•ç”¨ï¼‰_

### Chatwork é€šçŸ¥

LINE ãƒœãƒƒãƒˆã¨ãŠå®¢ã•ã¾ã®ã‚„ã‚Šå–ã‚Šã¯ LINE å…¬å¼ã‚¢ã‚«ã‚¦ãƒ³ãƒˆç®¡ç†ç”»é¢ã®ãƒãƒ£ãƒƒãƒˆãƒšãƒ¼ã‚¸ã‹ã‚‰ã‚‚ç¢ºèªã§ãã¾ã™ãŒã€æ¬¡å›é…é”ã®ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã‚„ã‚¯ãƒ¬ãƒ¼ãƒ ãªã©ã®ãŠå•ã„åˆã‚ã›ãŒã‚ã£ãŸæ™‚ã¯åˆ¥é€”é€šçŸ¥ãŒã‚ã‚‹æ–¹ãŒä¾¿åˆ©ã§ã™ã€‚é€šçŸ¥ã®æ–¹æ³•ã¯ãƒ¡ãƒ¼ãƒ«ã‚„ Slack ã§ã‚‚è‰¯ã‹ã£ãŸã§ã™ãŒã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®å¸Œæœ›ã§ Chatwork ã«ãªã‚Šã¾ã—ãŸã€‚

## ã‚·ã‚¹ãƒ†ãƒ è¦ä»¶

ä»Šå›ã®é–‹ç™ºã§æ±‚ã‚ã‚‰ã‚ŒãŸè¦ä»¶ã®ä¸€éƒ¨ã‚’ä¸‹è¨˜ã«ç¤ºã—ã¾ã™ã€‚

### LINE ãƒœãƒƒãƒˆ

- å½“æœˆã¨æ¬¡æœˆã®é…é”æ—¥ã‚’ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã§ç¢ºèªã§ãã‚‹ã“ã¨ã€‚
- æ¬¡å›ã¨æ¬¡ã€…å›ã®é…é”ã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã§ãã‚‹ã“ã¨ã€‚
- ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã™ã‚‹ã¨é…é”æ—¥ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã¸å³åº§ã«åæ˜ ã•ã‚Œã‚‹ã“ã¨ã€‚
- é…é”ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã®å–ã‚Šæ¶ˆã—ã¯ã§ããªã„ã“ã¨ï¼ˆé…é”æ—¥ã®ç›´å‰ã ã¨å¯¾å¿œã§ããªã„ã‚±ãƒ¼ã‚¹ãŒã‚ã‚‹ãŸã‚ï¼‰ã€‚
- ã‚¯ãƒ¬ãƒ¼ãƒ ã«ã¤ã„ã¦ã¯ã€ŒèŠ±ãŒå‚·ã‚“ã§ã„ãŸã€ã€Œå•†å“ãŒå±Šã„ã¦ã„ãªã„ã€ãªã©ã‚’ãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§é€ä¿¡ã§ãã‚‹ã“ã¨ã€‚
- ãŠé‡‘ã®ç½®ãå ´æ‰€ã«ã¤ã„ã¦ã¯ã€Œãƒã‚¹ãƒˆã®ä¸­ã€ã€Œç‰›ä¹³ç®±ã®ä¸­ã€ãªã©ã‚’ãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§é€ä¿¡ã§ãã‚‹ã“ã¨ã€‚
- å•†å“ã®ç½®ãå ´æ‰€ã«ã¤ã„ã¦ã¯ã€Œå‚˜ç«‹ã¦ã€ã€Œç„é–¢å‰ã€ãªã©ã‚’ãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§é€ä¿¡ã§ãã‚‹ã“ã¨ã€‚
- ã‚¯ãƒ¬ãƒ¼ãƒ ã¨ç½®ãå ´æ‰€ã§ã¯ã€Œãã®ä»–ã€ãƒœã‚¿ãƒ³ã‚’è¨­ã‘ã¦ãŠå®¢ã•ã¾ãŒå†…å®¹ã‚’ LINE ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¨ã—ã¦å…¥åŠ›ã§ãã‚‹ã“ã¨ã€‚
- ã€Œãã®ä»–ã€ã®å†…å®¹ã‚’ãŠå®¢ã•ã¾ãŒå…¥åŠ›ãƒ»é€ä¿¡ã—ãŸæ™‚ã«å—ä»˜ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¿”ä¿¡ã™ã‚‹ã“ã¨ã€‚
- ãŠå•ã„åˆã‚ã›ãŒã‚ã£ãŸæ™‚ã« Chatwork ã«é€šçŸ¥ã•ã‚Œã‚‹ã“ã¨ï¼ˆãŸã ã—é…é”æ—¥ã®ç¢ºèªã¯é™¤ãï¼‰ã€‚

### ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ 

- ãŠå®¢ã•ã¾ã® LINE ID ã¨é…é”æ—¥ã®ãƒ‡ãƒ¼ã‚¿ã‚’ Excel ã§ã‚¤ãƒ³ãƒãƒ¼ãƒˆï¼ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã§ãã‚‹ã“ã¨ã€‚
- ãŠå®¢ã•ã¾ã® LINE ID ã‚’è¤‡æ•°æŒ‡å®šã—ã¦ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ä¸€æ–‰é€ä¿¡ã§ãã‚‹ã“ã¨ã€‚

## ç”»é¢ãƒ•ãƒ­ãƒ¼

### ãƒªãƒƒãƒãƒ¡ãƒ‹ãƒ¥ãƒ¼

ãƒªãƒƒãƒãƒ¡ãƒ‹ãƒ¥ãƒ¼ã¯ä¸‹è¨˜ 4 ã¤ã®ãƒœã‚¿ãƒ³ã‹ã‚‰æ§‹æˆã•ã‚Œã¦ã„ã¾ã™ã€‚

- é…é”æ—¥ã®ç¢ºèª
- æ¬¡å›é…é”ã®ã‚­ãƒ£ãƒ³ã‚»ãƒ«
- ã‚¯ãƒ¬ãƒ¼ãƒ 
- ãŠé‡‘ã‚„å•†å“ã®ç½®ãå ´æ‰€

ãŠå®¢ã•ã¾ãŒå„ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã¨ã€Œ> é…é”æ—¥ã®ç¢ºèªã€ã®ã‚ˆã†ãªãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãŒãŠå®¢ã•ã¾ã® LINE ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¨ã—ã¦é€ä¿¡ã•ã‚Œã¾ã™ã€‚

ãƒªãƒƒãƒãƒ¡ãƒ‹ãƒ¥ãƒ¼ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ä¸‹è¨˜ã«ç¤ºã—ã¾ã™ï¼ˆå®Ÿéš›ã«ã¯ãƒœã‚¿ãƒ³ã¯ 2 è¡Œ 2 åˆ—ã§é…ç½®ã•ã‚Œã¾ã™ï¼‰ã€‚

```mermaid
graph LR
  subgraph ãƒªãƒƒãƒãƒ¡ãƒ‹ãƒ¥ãƒ¼
    é…é”æ—¥ã®ç¢ºèª
    æ¬¡å›é…é”ã®ã‚­ãƒ£ãƒ³ã‚»ãƒ«
    ã‚¯ãƒ¬ãƒ¼ãƒ 
    ãŠé‡‘ã‚„å•†å“ã®ç½®ãå ´æ‰€
  end
```

### é…é”æ—¥ã®ç¢ºèª

LINE ãƒœãƒƒãƒˆã¯ã€Œ> é…é”æ—¥ã®ç¢ºèªã€ã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’å—ä¿¡ã™ã‚‹ã¨é…é”æ—¥ã®ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚’è¿”ä¿¡ã—ã¾ã™ã€‚ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã®ç”Ÿæˆã«ã¯ä¸‹è¨˜ã®è¨˜äº‹ã‚’å‚è€ƒã«ã—ã¦ [Flex Message](https://developers.line.biz/ja/docs/messaging-api/using-flex-messages/) ã‚’ä½¿ã„ã¾ã—ãŸã€‚

https://qiita.com/7kaji/items/69c790efc9ed8813fe73

![LINE ãƒˆãƒ¼ã‚¯ç”»é¢ä¸‹éƒ¨ã« 6 ã¤ã®ãƒœã‚¿ãƒ³ã‹ã‚‰æ§‹æˆã•ã‚Œã‚‹ãƒ¡ãƒ‹ãƒ¥ãƒ¼ç”»åƒãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã¾ã™ã€‚](/images/articles/customer-support-automation-line-bot-development/calendar.png)
_ä¸Šè¨˜ã®è¨˜äº‹ã‚ˆã‚Šå¼•ç”¨_
